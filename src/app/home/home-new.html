<div class="home-content">
  <h2>Mes tÃ¢ches</h2>

  <!-- Composant de statistiques -->
  <app-task-stats [stats$]="stats$"></app-task-stats>

  <!-- Formulaire d'ajout -->
  <div class="task-input-section">
    <input 
      #taskInput 
      placeholder="Ajouter une nouvelle tÃ¢che..."
      (keyup.enter)="addTask(taskInput.value); taskInput.value = ''"
    >
    <button (click)="addTask(taskInput.value); taskInput.value = ''">
      Ajouter
    </button>
  </div>

  <!-- Liste des tÃ¢ches -->
  @if (tasks$ | async; as tasks) {
    @if (tasks.length > 0) {
      <ul>
        @for (task of tasks; track task.id) {
          <li [class.highlighted]="task.highlighted" [class.completed]="task.completed">
            <div class="task-content">
              <span class="task-title" [class.strike]="task.completed">{{ task.title }}</span>
              <div class="task-actions">
                <button 
                  class="btn-complete" 
                  (click)="toggleComplete(task.id)"
                  [class.active]="task.completed"
                  title="Marquer comme terminÃ©e"
                >
                  âœ“
                </button>
                <button 
                  class="btn-highlight" 
                  (click)="toggleHighlight(task.id)"
                  [class.active]="task.highlighted"
                  title="Mettre en avant"
                >
                  â­
                </button>
                <button 
                  class="btn-edit" 
                  (click)="openEditModal(task.id, task.title)"
                  title="Ã‰diter"
                >
                  âœï¸
                </button>
                <button 
                  class="btn-delete" 
                  (click)="deleteTask(task.id)"
                  title="Supprimer"
                >
                  ğŸ—‘ï¸
                </button>
              </div>
            </div>
            <!-- Container pour injection dynamique du composant highlight -->
            <div #highlightContainer></div>
          </li>
        }
      </ul>
    } @else {
      <div class="empty-state">
        <p>ğŸ“‹ Aucune tÃ¢che pour le moment. CrÃ©ez-en une !</p>
      </div>
    }
  } @else {
    <div class="loading">
      Chargement de vos tÃ¢ches...
    </div>
  }

  <!-- Modal d'Ã©dition (affichÃ© dynamiquement) -->
  @if (editingTaskId !== null && editingTaskTitle !== null) {
    <app-task-edit 
      [taskTitle]="editingTaskTitle"
      (save)="saveTaskEdit($event)"
      (cancel)="cancelTaskEdit()"
    ></app-task-edit>
  }
</div>
